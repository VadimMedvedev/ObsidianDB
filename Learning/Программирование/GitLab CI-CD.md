
https://chat.deepseek.com/share/i3wzl96cv5h4zbvgp8 - настройка пайплайнов для деплоя телеграм бота
https://chat.deepseek.com/share/jpv7wcjcerg596aovd - настройка доступа запуска скрипта deploy.sh


### Ранеры

ранеры нужны для выполнения джоб (т.е. это те сервера или контейнеры которые будут выполнять работу). Для того чтобы добавить новый ранер в проект заходим в настройки, потом CI/CD, а там в runner и следуем инструкции создания ранера.
для этого производим следующие операции
```
# Download the binary for your system
sudo curl -L --output /usr/local/bin/gitlab-runner https://gitlab-runner-downloads.s3.amazonaws.com/latest/binaries/gitlab-runner-linux-amd64

# Give it permission to execute
sudo chmod +x /usr/local/bin/gitlab-runner

# Create a GitLab Runner user
sudo useradd --comment 'GitLab Runner' --create-home gitlab-runner --shell /bin/bash

# Install and run as a service
sudo gitlab-runner install --user=gitlab-runner --working-directory=/home/gitlab-runner
sudo gitlab-runner start
```
И дальше по инструкции

!!! Когда мы инициализируем раннера, нам надо это делать от пользователя, от которого этот ранер потом будет запускаться!!! Если создать раннер на gitlab-runner тоже ничего хорошего не получится

Есть несколько главных команд у gitlab-runner
1) run - запускает раннер
2) list - выводит всех раннеров закреплённых за пользователем
3) register - регистрирует новый ранер для пользователя (нужен ещё токен и урл, это надо в гитлабе смотреть). Также при регистрации нужно будет указать gitlab сервер (можно сделать свой гитлаб сервер, а не использовать общий), название раннера которое будет использоваться на компьтере и как будут исполняться скрипты. 
4) unregister - удаляет раннер, ключом --name "str" можно задать какой именно


!!! ОЧЕНЬ ВАЖНО отключить у проекта использвание сторнних ранеров (settings > CI/CD > runners > Instance), иначе gitlab будет требовать подтверждения аккаунт, что не получиться сделать из-за санкций.

При том когда раннер начинает выполнять джобу, то весь репозиторий копируеться на раннер, и он стартует с этой директории. Таким образом ./ - корневая директория репозитория.

### Переменные

Переменные можно задавать в пайплайне.

Если нужно скрыть некоторые переменные, или вообще задать общие переменные, это можно сделать через settings > CI/CD > variables и добавить сколько угодно нужных переменных, которые потом будут считываться в пайплайне.